#+TITLE: My .bashrc snippets
#+AUTHOR: Sebastian Meisel

* Usage

 1) Clone the repository to =.bashrc.d= in your Home directory.
 2) To exclude certain snippets add an underscore (~_~) at the beginning of the filename.
 3) Add the following to your =.bashrc=:
#+BEGIN_SRC bash
  [[ -d ~.bashrc.d ]] && for f in ~/.bashrc.d/[0-9][0-9]-* ; do . ${f} ; done 
#+END_SRC

I use 00-obscureIPv6Prefix to hide my IPv6 prefix for online sharing. If you don't want this feature, remove all
occurences of =| opbscureIPv6= in 99-ip.

* Avaiable snippets
** 00-obscureIPv6Prefix — IPv6 prefix masking & helpers
  Small helpers to keep public outputs private by masking your global IPv6 prefix; includes wrappers for =tracepath= and =ip=.

#+begin_example

# Example

$ tracepath 2a01:a380:4400:15::1 # -> replaces 2a01:a380 with 3fff:abc: 
$ ip a                       # -> colors + privacy masking
#+end_example

* 01-PATH — Local user bin first
  Ensure =~/.local/bin= precedes system paths.
  #+begin_src bash
  export PATH=${HOME}/.local/bin:${PATH}
  #+end_src

* 02-PS1 — Minimal Git-aware, status-colored prompt
  Shows ✔/✘ based on last exit code and current Git branch (with * if dirty). Uses color vars from =08-colors=.

* 03-alias — Quality-of-life aliases
  File/basics + Git helpers.
  #+begin_src bash
  alias ßh=shh
  alias ß=ss

alias awk='awk -v OFS=" " '
alias pdfbook='pdfbook2 -spa4paper'
alias vim=nvim
alias suvi='sudo nvim'
alias gS='git status'
alias gC='git add -A && git commit -am'
alias gP='git push'
alias gF='git pull --rebase'

alias lsda='find . -maxdepth 1 -type d'
alias lsd="lsda -not -regex '^./..*'"
#+end_src

* 05-calc — Shell calculator (=, =x=, =b=, …)
  Convenient bc-based calculator with locale-friendly input/output and base conversions.

#+begin_example
= "12,5 · 3"          # -> 37,50
=x 255               # -> FF
=b 13                # -> 1101
=bx "1111 0000 1010"   # -> F0 0A
#+end_example

* 06-cargo — Rust toolchain path
  #+begin_src bash
  export PATH=/home/sebastian/.cargo/bin:${PATH}
  #+end_src

* 07-cdpath — Faster =cd= across common roots
  #+begin_src bash
  export CDPATH=.:~~:~~/git:/etc:~~/Dokumente:~~/Documents
  #+end_src

* 08-colors — ANSI color variables (prompt-safe + raw)
  Defines prompt-escaped and raw colors; also enriches =awk= with colors and tabular OFS.
  #+begin_src bash
  export RAW_R="033[31m"
  export G="$033[32m$"
  export Y="$033[33m$"
  export B="$033[34m$"
  export M="$033[35m$"
  export C="$033[36m$"
  export N="$033[0m$"
  export RAW_G="033[32m"
  export RAW_Y="033[33m"
  export RAW_B="033[34m"
  export RAW_M="033[35m"
  export RAW_C="033[36m"
  export RAW_N="033[0m"

alias awk='awk -v r=$RAW_R -v g=$RAW_G -v y=$RAW_Y -v b=$RAW_B -v m=$RAW_M -v c=$RAW_C -v n=$RAW_N -v OFS="	"'
#+end_src

* 09-curl — Quick weather via wttr.in
  Simple helper for terminal weather (defaults to Mölschow).
  #+begin_src bash
  function wetter () {
  local PLACE=${1:-"Mölschow"}
  curl https:/wttr.in/${PLACE}
  }
  #+end_src

* 10-distrowatch — Enter Arch distrobox (root)
  #+begin_src bash
  alias arch='distrobox enter --root arch'
  #+end_src

* 11-eat — EAT shell integration (if available)
  #+begin_src bash
  [ -n "$EAT_SHELL_INTEGRATION_DIR" ] && source "$EAT_SHELL_INTEGRATION_DIR/bash"
  #+end_src

* 12-editor — Default editor
  #+begin_src bash
  EDITOR=nvim
  #+end_src

* 13-fontpreview — UI tuning
  Environment for =fontpreview= (size, position, prompt, text).
  #+begin_src bash
  export FONTPREVIEW_SEARCH_PROMPT="❯ "
  export FONTPREVIEW_SIZE=532x365
  export FONTPREVIEW_POSITION="+532+365"
  export FONTPREVIEW_FONT_SIZE=38
  export FONTPREVIEW_BG_COLOR="#ffffff"
  export FONTPREVIEW_FG_COLOR="#000000"
  export FONTPREVIEW_PREVIEW_TEXT="ABCDEFGHIJKLMnNOPQRSTUVWXYZnÄÖßẞnabcdefghijklmnnopqrstuvwxyzn1234567890n!@$%(){}[]"
  #+end_src

* 14-grepln — Jump to first match in file
  Find line number of first match and open in Emacs there.
  #+begin_src bash
  function grepln () {
  PATTERN=$1
  FILE=$2
  grep -n -E "$PATTERN" "$FILE"  | head -1 | awk -F: '{print $1}'
  }
  function emacsln () {
  PATTERN=$1
  FILE=$2
  emacsclient -nc +$(grepln "$PATTERN" "$FILE") "$FILE"
  }
  #+end_src

* 15-here — Inline Python scratchpad
  Replace =helper.py= and execute it from a here-doc.
  #+begin_src bash
  alias pyhere='mv helper.py helper.py~; cat << . > helper.py && python3 helper.py'
  #+end_src

* 16-lpr — Even/odd print helpers
  Targets printer “EcoTank”.
  #+begin_src bash
  alias lpodd='lpr -o page-set=odd -P EcoTank'
  alias lpeven='lpr -o page-set=even -P EcoTank'
  #+end_src

* 17-man — Search-in-=-less= man wrapper
  Supports optional section and initial search (=less -p=).
  #+begin_src bash
  function man() {
  manual="/usr/bin/man"
  local section=""
  local search_arg=""

  if [[ $1 =~ ^[1-9]$ ]]; then
  section=$1
  shift
  fi

  local command=$1
  shift

  if [[ $# -ge 1 ]]; then
  search_arg="-p $(printf '%q' $@)"
  fi

  $manual $section "$command" | less $search_arg
  }
  #+end_src
  #+begin_example
  man 2 open O_CLOEXEC     # open section 2 and search for O_CLOEXEC
  #+end_example

* 18-mkcd — Make and enter directory
  #+begin_src bash
  function mkcd () { mkdir $@; cd $_; }
  #+end_src

* 19-ntfy — Tiny notify helper
  POST a message to an ntfy endpoint (here: =ln1/tea=).
  #+begin_src bash
  function ntfy () {
  curl -d "$@" ln1/tea
  }
  #+end_src

* 20-options — Safer shell defaults
  =Cnoclobber= for redirections; enable =autocd= and =cdspell=.
  #+begin_src bash
  set -C
  shopt -s autocd
  shopt -s cdspell
  #+end_src

* 21-perl — Local::lib environment
  Per-user Perl install locations.
  #+begin_src bash
  PATH="/home/sebastian/perl5/bin${PATH:+:${PATH}}"; export PATH;
  PERL5LIB="/home/sebastian/perl5/lib/perl5${PERL5LIB:+:${PERL5LIB}}"; export PERL5LIB;
  PERL_LOCAL_LIB_ROOT="/home/sebastian/perl5${PERL_LOCAL_LIB_ROOT:+:${PERL_LOCAL_LIB_ROOT}}"; export PERL_LOCAL_LIB_ROOT;
  PERL_MB_OPT="--install_base "/home/sebastian/perl5""; export PERL_MB_OPT;
  PERL_MM_OPT="INSTALL_BASE=/home/sebastian/perl5"; export PERL_MM_OPT;
  #+end_src

* 22-python — pyenv paths
  Prefer user Python tools.
  #+begin_src bash
  PATH=${HOME}/.pyenv/bin/:~/.pyenv/versions/3.13.1/bin/:${PATH}
  #+end_src

* 23-sudo_functions — Polite sudo :)
  #+begin_src bash
  function please { echo "You're welcome!"; echo; sudo $@;}
  function bitte  { echo "Gerne!"; echo; sudo $@;}
  #+end_src

* 24-tex — Local TEXMF
  #+begin_src bash
  export TEXMFHOME=${HOME}/Dropbox/TeX/texmf
  #+end_src

* 25-tmux.completion.bash — tmux bash completion
  Drop-in tmux completion script (clients/sessions/windows).
  #+begin_src bash
  #!/usr/bin/env bash

# (script truncated for brevity in docs — keep full content in repo)

_tmux_expand () { [ "$cur" != "${cur%}" ] && cur="$cur"''; if [[ "$cur" == ~*/* ]]; then eval cur=$cur; else if [[ "$cur" == ~* ]]; then cur=${cur#~}; COMPREPLY=($( compgen -P '~' -u $cur )); return ${#COMPREPLY[@]}; fi; fi }
_tmux_filedir () { local IFS='
'; _tmux_expand || return 0; if [ "$1" = -d ]; then COMPREPLY=(${COMPREPLY[@]} $( compgen -d -- $cur )); return 0; fi; COMPREPLY=(${COMPREPLY[@]} $( eval compgen -f -- "$cur" )) }

# ... full completion implementation ...

complete -F _tmux tmux

# END tmux completion

#+end_src

* 26-units.sh — IEC size helpers
  Convert KiB/MiB/GiB/TiB/PiB to raw bytes using =bc=.
  #+begin_src bash
  function KiB() { bytes=$1; printf "%s Bn" $(echo "$1 * 2^10" | bc); }
  function MiB() { bytes=$1; printf "%s Bn" $(echo "$1 * 2^20" | bc); }
  function GiB() { bytes=$1; printf "%s Bn" $(echo "$1 * 2^30" | bc); }
  function TiB() { bytes=$1; printf "%s Bn" $(echo "$1 * 2^40" | bc); }
  function PiB() { bytes=$1; printf "%s Bn" $(echo "$1 * 2^50" | bc); }
  #+end_src

* 27-update — Distro-aware updater (+notify)
  Try =zypper=, then =dnf=, then =apt=; sends =ntfy= on success/failure.
  #+begin_src bash
  #!/bin/bash
  update () {
  if ( sudo test -x /bin/zypper )
  then
  sudo zypper dup -y && ntfy "Update auf $HOSTNAME erfolgreich!" || "Update auf $HOSTNAME fehlgeschlagen"
  elif ( sudo test -x /bin/dnf )
  then
  sudo dnf update -y && ntfy "Update auf $HOSTNAME erfolgreich!" || "Update auf $HOSTNAME fehlgeschlagen"
  elif ( sudo test -x /bin/apt )
  then
  sudo apt update && sudo apt upgrade -y && ntfy "Update auf $HOSTNAME erfolgreich!" || "Update auf $HOSTNAME fehlgeschlagen"
  fi
  }
  #+end_src

* 28-yt-dlp — Run via pipenv
  #+begin_src bash
  alias yt-dlp='pipenv run yt-dlp'
  #+end_src

* 29-AnwesenheitTeams — Attendance cleanup (Teams)
  Normalize/export meeting attendance lists (CSV from Teams).
  #+begin_src bash
  function Anwesenheit () {
  file=${1:-"meetingAttendanceList.csv"}
  iconv -f UTF-16LE -t UTF-8  ${file} |
  awk '/Meisel|Anwesenheit/{next}; NR>1 {print $0}' |
  sort -k1,2 -u | column -ts,
  }
  #+end_src

* 30-lastout — Bookmark and recall command output
  Pipe any output through =lout= to number & cache it; recall a line via =? N=.
  #+begin_src bash
  function lout () { tee ~/.lastout | nl; }
  function ? () { awk -v LINE=$1 'NR==LINE {print $0}' ~/.lastout; }
  #+end_src
  #+begin_example
  ls -l /usr/bin | lout
  ? 2
  #+end_example

* 99-ip — Pretty =ip= / =ping= wrappers (with privacy)
  Colorizes =ip --brief=, aligns routing/neighbor info, and masks IPv6 prefix. =ping= auto-restores your real prefix for testing.
  #+begin_src bash
  #!/bin/bash
  function ipbrief() {
  /usr/sbin/ip --brief -h -s "$@" | sed -E 's/[[:space:]]+/ /g' | sort -k2 |&#x20;
  awk ' ... (full AWK from file) ... ' | obscureIPv6
  }
  function ping() {
  IPv6Prefix="$(/usr/sbin/ip a | sed '/lo:/,+5d' | grep -Ev ' (fd[[:xdigit:]]{2}:|fe80:)' | grep -m1 inet6 | grep --color=never -Eo '[^:]2[[:xdigit:]]{3}:[[:xdigit:]]{1,4}:')"
  pingARG=$(echo -n "$@" | sed "s/3fff:abc:/${IPv6Prefix}/g")
  /usr/bin/ping ${pingARG} | obscureIPv6
  }
  alias ip='ip -h -s --color=always'
  #+end_src
  #+begin_example
  ipbrief a
  ping 3fff:abc:1234::1
  #+end_example

* 06–24/22/01 etc. — Path & environment snippets (index)
  For discoverability, here’s a quick index to the short env/path snippets above:

- =01-PATH= : =~/.local/bin= first
- =06-cargo= : Rust toolchain path
- =07-cdpath= : =CDPATH= roots
- =12-editor= : =EDITOR=nvim=
- =21-perl= : local::lib Perl env
- =22-python= : =pyenv= shims
- =24-tex= : =TEXMFHOME=
- =28-yt-dlp= : run via =pipenv=

---

* Notes

 - Some helpers rely on others (e.g., =ipbrief= → =obscureIPv6=, prompt colors → =08-colors=). Source order matters.
 - Aliases/functions with Unicode names (e.g., =ß=) require UTF-8 locale in your shell.
------


# Local Variables:
# jinx-languages: "en_US"
# End:
