#+TITLE: My .bashrc snippets
#+AUTHOR: Sebastian Meisel

* Overview

A collection of modular bash configuration snippets for enhanced shell productivity.
Each snippet is a self-contained file that adds specific functionality to your bash environment.

* Features

- *Modular design*: Each script handles one specific task or feature
- *Easy to customize*: Simply prefix unwanted scripts with =_= to disable them
- *Well-documented*: All scripts now include comprehensive inline comments
- *No dependencies between most scripts*: Pick and choose what you need
- *Organized by number*: Scripts load in a predictable order (00-99)

* Usage

** Prerequisites 

To use =atuin= (=60-atuin=) install [[https:https://github.com/akinomyoga/ble.sh][ble.sh]] and 

** Installation

 1) Clone the repository to =.bashrc.d= in your Home directory:
    #+BEGIN_SRC bash
    git clone <repository-url> ~/.bashrc.d
    #+END_SRC

 2) Add the following to your =.bashrc= to source all numbered scripts:
    #+BEGIN_SRC bash
    [[ -d ~/.bashrc.d ]] && for f in ~/.bashrc.d/[0-9][0-9]-* ; do . ${f} ; done 
    #+END_SRC

 3) Restart your shell or run =source ~/.bashrc= to apply changes.
** Customization

To exclude certain snippets, add an underscore (~_~) at the beginning of the filename.
For example, to disable the weather function:
#+BEGIN_SRC bash
mv ~/.bashrc.d/09-curl ~/.bashrc.d/_09-curl
#+END_SRC

** Privacy Note

I use =90-obscureIPv6Prefix= to hide my IPv6 prefix when sharing terminal output online.
If you don't want this feature, you can:
- Disable it by renaming: =mv 90-obscureIPv6Prefix _90-obscureIPv6Prefix=
- Or remove all occurrences of =| obscureIPv6= in =91-ip= and =90-obscureIPv6Prefix=

* Quick Reference

Here's a summary of the most useful functions and aliases:

| Command/Function | Description | Example |
|------------------+-------------+---------|
| ~=~ | Calculator with European number format | ~=~ "12,5 · 3"   |
| ~=x~  | Convert decimal to hex | ~=x 255~   |
| ~=b~  | Convert decimal to binary | ~=b 13~   |
| =gS=, =gC=, =gP=, =gF= | Git shortcuts (status/commit/push/pull) | =gC "Fix bug"= |
| =ipbrief= | Colorized, formatted network info | =ipbrief a= |
| =wetter= | Get weather for location | =wetter Berlin= |
| =mkcd= | Create directory and cd into it | =mkcd newdir= |
| =please= / =bitte= | Polite sudo | =please dnf update= |
| =lout= / =?= | Bookmark command output | =ls \vert lout=, then =? 5= |
| =grepln= / =emacsln= | Find & open file at pattern | =emacsln "TODO" file.txt= |
| =Anwesenheit= | Process Teams attendance CSV | =Anwesenheit meeting.csv= |
| =KiB=, =MiB=, =GiB= | Convert IEC units to bytes | =GiB 5= |
| =tesed= | Test sed changes interactively | =tesed 's/old/new/g' file= |

* Available snippets

Scripts are now organized into logical groups:
- *00-09*: Core shell configuration (colors, options, PATH, prompt)
- *10-19*: Language-specific PATH setup (Rust, Perl, Python, TeX)
- *20-29*: Terminal integration and tools (Eat, Atuin, tmux, editor)
- *30-39*: Aliases and shortcuts
- *40-49*: Directory and file operations
- *50-59*: Shell functions and utilities
- *60-69*: Calculation and conversion tools
- *70-79*: Text and data processing
- *80-89*: Application-specific tools
- *90-99*: Network and privacy tools

** 00-colors — ANSI color variables (prompt-safe + raw)
  Defines prompt-escaped and raw colors; also enriches =awk= with colors and tabular OFS.
  #+begin_src bash
  export RAW_R="\033[31m"
  export G="\[\033[32m\]"
  export Y="\[\033[33m\]"
  export B="\[\033[34m\]"
  export M="\[\033[35m\]"
  export C="\[\033[36m\]"
  export N="\[\033[0m\]"
  export RAW_G="\033[32m"
  export RAW_Y="\033[33m"
  export RAW_B="\033[34m"
  export RAW_M="\033[35m"
  export RAW_C="\033[36m"
  export RAW_N="\033[0m"

alias awk='awk -v r=$RAW_R -v g=$RAW_G -v y=$RAW_Y -v b=$RAW_B -v m=$RAW_M -v c=$RAW_C -v n=$RAW_N -v OFS="\t"'
#+end_src

** 01-options — Safer shell defaults
  =noclobber= for redirections; enable =autocd= and =cdspell=.
  #+begin_src bash
  set -C
  shopt -s autocd
  shopt -s cdspell
  #+end_src

** 02-PATH — Local user bin first
  Ensure =~/.local/bin= precedes system paths.
  #+begin_src bash
  export PATH=${HOME}/.local/bin:${PATH}
  #+end_src

** 03-PS1 — Minimal Git-aware, status-colored prompt
  Shows ✔/✘ based on last exit code and current Git branch (with * if dirty). Uses color vars from =00-colors=.

** 10-cargo — Rust toolchain path
  #+begin_src bash
  export PATH=/home/sebastian/.cargo/bin:${PATH}
  #+end_src

** 11-perl — Local::lib environment
  Per-user Perl install locations.
  #+begin_src bash
  PATH="/home/sebastian/perl5/bin${PATH:+:${PATH}}"; export PATH;
  PERL5LIB="/home/sebastian/perl5/lib/perl5${PERL5LIB:+:${PERL5LIB}}"; export PERL5LIB;
  PERL_LOCAL_LIB_ROOT="/home/sebastian/perl5${PERL_LOCAL_LIB_ROOT:+:${PERL_LOCAL_LIB_ROOT}}"; export PERL_LOCAL_LIB_ROOT;
  PERL_MB_OPT="--install_base \"/home/sebastian/perl5\""; export PERL_MB_OPT;
  PERL_MM_OPT="INSTALL_BASE=/home/sebastian/perl5"; export PERL_MM_OPT;
  #+end_src

** 12-python — pyenv paths
  Prefer user Python tools.
  #+begin_src bash
  PATH=${HOME}/.pyenv/bin/:~/.pyenv/versions/3.13.1/bin/:${PATH}
  #+end_src

** 13-tex — Local TEXMF
  #+begin_src bash
  export TEXMFHOME=${HOME}/Dropbox/TeX/texmf
  #+end_src

** 20-eat — EAT shell integration (if available)
  #+begin_src bash
  [ -n "$EAT_SHELL_INTEGRATION_DIR" ] && source "$EAT_SHELL_INTEGRATION_DIR/bash"
  #+end_src

** 21-atuin — Shell history tool
  Improved shell history with sync and search capabilities.

** 22-tmux.completion.bash — tmux bash completion
  Drop-in tmux completion script (clients/sessions/windows).

** 23-editor — Default editor
  #+begin_src bash
  EDITOR=nvim
  #+end_src

** 24-fontpreview — UI tuning
  Environment for =fontpreview= (size, position, prompt, text).
  #+begin_src bash
  export FONTPREVIEW_SEARCH_PROMPT="❯ "
  export FONTPREVIEW_SIZE=532x365
  export FONTPREVIEW_POSITION="+532+365"
  export FONTPREVIEW_FONT_SIZE=38
  export FONTPREVIEW_BG_COLOR="#ffffff"
  export FONTPREVIEW_FG_COLOR="#000000"
  export FONTPREVIEW_PREVIEW_TEXT="ABCDEFGHIJKLM\nNOPQRSTUVWXYZ\nÄÖßẞ\nabcdefghijklm\nnopqrstuvwxyz\n1234567890\n!@$%(){}[]"
  #+end_src

** 30-alias — Quality-of-life aliases
  File/basics + Git helpers.
  #+begin_src bash
  alias ßh=shh
  alias ß=ss

alias awk='awk -v OFS=" " '
alias pdfbook='pdfbook2 -spa4paper'
alias vim=nvim
alias suvi='sudo nvim'
alias gS='git status'
alias gC='git add -A && git commit -am'
alias gP='git push'
alias gF='git pull --rebase'

alias lsda='find . -maxdepth 1 -type d'
alias lsd="lsda -not -regex '^./..*'"
#+end_src

** 31-sudo_functions — Polite sudo :)
  #+begin_src bash
  function please { echo "You're welcome!"; echo; sudo $@;}
  function bitte  { echo "Gerne!"; echo; sudo $@;}
  #+end_src

** 32-cdpath — Faster =cd= across common roots
  #+begin_src bash
  export CDPATH=.:~:~/git:/etc:~/Dokumente:~/Documents
  #+end_src

** 40-mkcd — Make and enter directory
  #+begin_src bash
  function mkcd () { mkdir $@; cd $_; }
  #+end_src

** 50-man — Search-in-=less= man wrapper
  Supports optional section and initial search (=less -p=).
  #+begin_example
  man 2 open O_CLOEXEC     # open section 2 and search for O_CLOEXEC
  #+end_example

** 51-grepln — Jump to first match in file
  Find line number of first match and open in Emacs there.
  #+begin_src bash
  function grepln () {
  PATTERN=$1
  FILE=$2
  grep -n -E "$PATTERN" "$FILE"  | head -1 | awk -F: '{print $1}'
  }
  function emacsln () {
  PATTERN=$1
  FILE=$2
  emacsclient -nc +$(grepln "$PATTERN" "$FILE") "$FILE"
  }
  #+end_src

** 52-here — Inline Python scratchpad
  Replace =helper.py= and execute it from a here-doc.
  #+begin_src bash
  alias pyhere='mv helper.py helper.py~; cat << . > helper.py && python3 helper.py'
  #+end_src

** 53-lastout — Bookmark and recall command output
  Pipe any output through =lout= to number & cache it; recall a line via =? N=.
  #+begin_src bash
  function lout () { tee ~/.lastout | nl; }
  function ? () { awk -v LINE=$1 'NR==LINE {print $0}' ~/.lastout; }
  #+end_src
  #+begin_example
  ls -l /usr/bin | lout
  ? 2
  #+end_example

** 54-sed-test — Interactive sed tester
  Preview sed changes before applying.
  #+begin_example
  tesed 's/old/new/g' myfile.txt
  #+end_example

** 60-calc — Shell calculator (=, =x=, =b=, …)
  Convenient bc-based calculator with locale-friendly input/output and base conversions.

#+begin_example
= "12,5 · 3"          # -> 37,50
=x 255               # -> FF
=b 13                # -> 1101
=bx "1111 0000 1010"   # -> F0 0A
#+end_example

** 61-units.sh — IEC size helpers
  Convert KiB/MiB/GiB/TiB/PiB to raw bytes using =bc=.
  #+begin_src bash
  function KiB() { bytes=$1; printf "%s B\n" $(echo "$1 * 2^10" | bc); }
  function MiB() { bytes=$1; printf "%s B\n" $(echo "$1 * 2^20" | bc); }
  function GiB() { bytes=$1; printf "%s B\n" $(echo "$1 * 2^30" | bc); }
  function TiB() { bytes=$1; printf "%s B\n" $(echo "$1 * 2^40" | bc); }
  function PiB() { bytes=$1; printf "%s B\n" $(echo "$1 * 2^50" | bc); }
  #+end_src

** 70-AnwesenheitTeams — Attendance cleanup (Teams)
  Normalize/export meeting attendance lists (CSV from Teams).
  #+begin_src bash
  function Anwesenheit () {
  file=${1:-"meetingAttendanceList.csv"}
  iconv -f UTF-16LE -t UTF-8  ${file} |
  awk '/Meisel|Anwesenheit/{next}; NR>1 {print $0}' |
  sort -k1,2 -u | column -ts,
  }
  #+end_src

** 71-lpr — Even/odd print helpers
  Targets printer "EPSON ET-2820".
  #+begin_src bash
  alias lpodd='lpr -o page-set=odd -P EPSON_ET_2820_Series'
  alias lpeven='lpr -o page-set=even -P EPSON_ET_2820_Series'
  #+end_src

** 80-curl — Quick weather via wttr.in
  Simple helper for terminal weather (defaults to Mölschow).
  #+begin_src bash
  function wetter () {
  local PLACE=${1:-"Mölschow"}
  curl https:/wttr.in/${PLACE}
  }
  #+end_src

** 81-ntfy — Tiny notify helper
  POST a message to an ntfy endpoint (here: =ln1/tea=).
  #+begin_src bash
  function ntfy () {
  curl -d "$@" ln1/tea
  }
  #+end_src

** 82-update — Distro-aware updater (+notify)
  Try =zypper=, then =dnf=, then =apt=; sends =ntfy= on success/failure.
  #+begin_src bash
  #!/bin/bash
  update () {
  if ( sudo test -x /bin/zypper )
  then
  sudo zypper dup -y && ntfy "Update auf $HOSTNAME erfolgreich!" || "Update auf $HOSTNAME fehlgeschlagen"
  elif ( sudo test -x /bin/dnf )
  then
  sudo dnf update -y && ntfy "Update auf $HOSTNAME erfolgreich!" || "Update auf $HOSTNAME fehlgeschlagen"
  elif ( sudo test -x /bin/apt )
  then
  sudo apt update && sudo apt upgrade -y && ntfy "Update auf $HOSTNAME erfolgreich!" || "Update auf $HOSTNAME fehlgeschlagen"
  fi
  }
  #+end_src

** 83-yt-dlp — Run via pipenv
  #+begin_src bash
  alias yt-dlp='pipenv run yt-dlp'
  #+end_src

** 84-distrobox — Enter Arch distrobox (root)
  #+begin_src bash
  alias arch='distrobox enter --root arch'
  #+end_src

** 90-obscureIPv6Prefix — IPv6 prefix masking & helpers
  Small helpers to keep public outputs private by masking your global IPv6 prefix; includes wrappers for =tracepath= and =ip=.

#+begin_example

# Example

$ tracepath 2a01:a380:4400:15::1 # -> replaces 2a01:a380 with 3fff:abc: 
$ ip a                       # -> colors + privacy masking
#+end_example

** 91-ip — Pretty =ip= / =ping= wrappers (with privacy)
  Colorizes =ip --brief=, aligns routing/neighbor info, and masks IPv6 prefix. =ping= auto-restores your real prefix for testing.
  #+begin_example
  ipbrief a
  ping 3fff:abc:1234::1
  #+end_example

* Dependencies & Requirements

** Script Dependencies

Some scripts depend on others:
- =02-PS1= (prompt) requires =08-colors= for color variables
- =99-ip= and related functions use =00-obscureIPv6Prefix= for privacy masking
- Source order matters: scripts are loaded in numerical order (00-99)

** External Tools

Some scripts require external tools to be installed:
- =05-calc=: requires =bc= (calculator)
- =10-distrowatch=: requires =distrobox=
- =11-eat=: requires Emacs with Eat terminal emulator
- =13-fontpreview=: requires =fontpreview= utility
- =19-ntfy= / =27-update=: require =curl= and ntfy.sh service
- =26-units.sh=: requires =bc= (calculator)
- =28-yt-dlp=: requires =pipenv= and =yt-dlp=
- =atuin=: requires Atuin shell history tool

** Locale Requirements

- Aliases/functions with Unicode names (e.g., =ß= in =03-alias=) require UTF-8 locale
- Set in your shell: =export LANG=en_US.UTF-8= or similar

* Troubleshooting

** Scripts Not Loading

If your scripts aren't being sourced:
1. Check that the sourcing line is in your =~/.bashrc= (not =~/.bash_profile=)
2. Verify the glob pattern matches your files: =ls ~/.bashrc.d/[0-9][0-9]-*=
3. Ensure files are readable: =chmod +r ~/.bashrc.d/*=

** Function Not Found

If a function isn't available:
1. Check if the script is prefixed with =_= (disabled)
2. Verify the script loaded: =type function_name=
3. Check for syntax errors: =bash -n ~/.bashrc.d/script-name=

** Path Issues

If custom paths aren't working:
1. Check load order - PATH scripts (01, 06, 21, 22) should load early
2. Verify paths exist: =ls -ld ~/.local/bin ~/.cargo/bin=
3. Reload your shell or run =source ~/.bashrc=

------


# Local Variables:
# jinx-languages: "en_US"
# End:
